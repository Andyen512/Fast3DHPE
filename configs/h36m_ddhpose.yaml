# ========= 数据集部分 =========
DATASET:
  name: "h36m"                   # 数据集名称，会影响加载路径
  root: "data"                   # 存放 data_3d_h36m.npz / data_2d_h36m_xxx.npz 的目录
  keypoints: "cpn_ft_h36m_dbb"   # 你用的 2D 关键点检测器名字
  subjects_train: "S1,S5,S6,S7,S8"   # 训练 subject
  subjects_unlabeled:  ""           # 测试 subject
  subjects_test: "S9,S11"             # 半监督用的（可空）
  seq_len: 243                   # 每个 clip 的帧数
  downsample: 1                  # 全局下采样因子
  train_stride: 81               # 训练时滑窗步长（例：81）
  eval_stride: 243               # 测试时滑窗步长（整段一窗）
  subset: 1.0                    # 子集比例（可用 <1.0 做小样本实验）
  bone_index:                     # 如果要骨长/骨向损失，可以列出骨骼 (i,j) 对
    - [0, 1]
    - [1, 2]
    - [2, 3]
    # ... 你可以从 skeleton 里补全
  number_of_frames: 243
  batch_size: 1024
  stride: 243

  Test:
    actions: '*'   
    P2: True         

# ========= 模型部分 =========
MODEL:
  name: "DDHPose"
  backbone:
    num_frame: 243   # 对齐数据长度
    num_joints: 17
    in_chans: 6                     # 输入通道（2D坐标 → x,y）
    embed_dim_ratio: 512
    depth: 8
    num_heads: 8
    mlp_ratio: 2.0
    qkv_bias: True
    drop_rate: 0.
    attn_drop_rate: 0.
    drop_path_rate: 0.2
    is_train: True
    test_time_augmentation: True
    timestep: 1000
    scale: 1
    num_proposals: 1
    sampling_timesteps: 1
    boneindextemp: '0,1,1,2,2,3,0,4,4,5,5,6,0,7,7,8,8,9,9,10,8,11,11,12,12,13,8,14,14,15,15,16'

# ========= 损失 =========
LOSS:
  type: "Dis_MPJPELoss"
  log_prefix: "dis_mpjpe"
  loss_term_weight: 1.0
  boneindextemp: '0,1,1,2,2,3,0,4,4,5,5,6,0,7,7,8,8,9,9,10,8,11,11,12,12,13,8,14,14,15,15,16'

# ========= 优化器 & 学习率 =========
OPTIM:
  name: "AdamW"
  lr: 1.5e-4
  weight_decay: 0.05
  betas: [0.9, 0.999]
  clip_grad_norm: 1.0
  lr_decay: 0.999

SCHED:
  name: "Cosine"
  warmup_epochs: 5
  max_epochs: 400

# ========= 训练引擎 =========
ENGINE:
  save_name: "h36m_mixste2"    # 保存路径的一部分
  amp: true                    # 自动混合精度
  find_unused_parameters: false
  log_interval: 50
  val_interval: 1
  save_freq: 100

# ========= 运行时设置 =========
RUNTIME:
  batch_size: 16
  num_workers: 8
  seed: 42

DEBUG: False
EVAL: True